from flask import Flask, request
import requests

app = Flask(__name__)

@app.route('/check_cve')
def check_cve():
    cve_id = request.args.get('cve_id')
    url = f'https://cve.circl.lu/api/cve/{cve_id}'
    response = requests.get(url)
    if response.status_code == 200:
        cve_info = response.json()
        return f"{' '.join(cve_info['cve']['description']['description_data'][0]['value'].split()[:10])}..."
    else:
        return "CVE not found"

if __name__ == '__main__':
    app.run()
